---
title: "R Bootcamp Einstein 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# SECTION 1 - The Basics
### Installing R

If you don't have them already installed you need to download and install R and R studio  

- Download R
    - <https://cran.r-project.org/>  
- R Studio
    - <https://www.rstudio.com/products/rstudio/download/>


### Introduction to R

- R is an open source programming environment
- It is most commonly used for statistical computing and graphics
- The basic functionality of R can be extended with 'packages'

### Resources for R

 - R for data science <http://r4ds.had.co.nz> 
     - Served as inspiration for a lot of this bootcamp
     - Written by programmers at R Studio
 - R Programming for Data Science <https://bookdown.org/rdpeng/rprogdatascience/>
 - R Bootcamp <https://www.jaredknowles.com/r-bootcamp/>


### Introduction to R studio

- R studio is an IDE within which you can write/edit code, run code, display plots/graphics and a whole host of other functions 

![](RStudio-Screenshot.png)

### Getting Started


- Go to <https://github.com/mseinstein/> to download the Presentions > RBootCamp > r_bootcamp_einstein_2017.R file   
- All the code presented here is within that R file

### Running code in R

- To run any line of code use <kbd>CTRL</kbd>+<kbd>Enter</kbd> or <kbd>Cmd</kbd>+<kbd>Enter</kbd> 
    - R will run the highlighted code OR
    - R will run the line of code which the cursor is on
    

### Installing and Loading packages
 - The power of R can be extended with packages
 - Tidyverse is a collection of R packages that share common philosophies and are designed to work together
     - This is the main package we will be using 
     
`install.packages("tidyverse")` # only needs to be done once per machine

`library(tidyverse)` # needs to be loaded every session you want to use it (usually everytime you open R studio)

### Key Symbols

- < - 
    - Assignment operator, e.g. x <- 5
    - The equals sign, =, will work as a substitution in most but not all cases
- `#`
    - Denotes a comment
    - All text following the `#` will be ignored
- `?`function_name 
    - Opens the Documentation for the function
- `??`term
    - Searches the help documentation for the queried string


# SECTION 2 - Data Visualisations with ggplot2
 - ggplot2 is a plotting system for R, based on the grammar of graphics
 - See http://vita.had.co.nz/papers/layered-grammar.pdf for an in-depth discussion

`library(tidyverse)`

## Graphics in ggplot are built in layers
```{r, echo=FALSE,include=FALSE}
library(tidyverse)
```

```{r}
mpg # dataset built in to ggplot
summary(mpg) 
mpg$drv
```

- The ggplot command begins a plot to which you can add layers
```{r, message=FALSE}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy))
ggplot(data = mpg) +
  geom_smooth(mapping = aes(x = displ, y = hwy)) + geom_point(mapping = aes(x = displ, y = hwy))
```


By inserting x and y into ggplot all layers will use those parameters unless otherwise specified
```{r message=FALSE}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + geom_smooth() + geom_point()

ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + geom_smooth() + geom_point() +
  geom_smooth(mapping = aes(x = displ,y = cty),color = "red")
```


Note: if you want to plot a variable to a feature like color or size, it must go in the aes() term, if you just want to set them at a certain value they go outside the aes
```{r message=FALSE} 
ggplot(mpg, aes(displ,hwy)) + geom_smooth(color = "green") + geom_point(aes(color=class),size=2) 
```

You can also split the plot into subplots based on a varible using `facet`
```{r}
ggplot(mpg, aes(displ,hwy))  + geom_point() + facet_grid(.~cyl)
ggplot(mpg, aes(displ,hwy))  + geom_point() + facet_grid(cyl~.)
ggplot(mpg, aes(displ,hwy))  + geom_point() + facet_wrap(~cyl)
ggplot(mpg, aes(displ,hwy))  + geom_point() + facet_grid(cyl~class)
```

Play with ggplot trying to make some of the following plots:
```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.height=4}
ggplot(mpg)  + geom_point(aes(displ,hwy,size=class),color="blue",shape=17) 

ggplot(mpg) + 
  geom_smooth(aes(displ,hwy, linetype = drv))

ggplot(mpg,aes(displ,hwy,color=drv)) + 
  geom_smooth(se=FALSE,show.legend = FALSE) +
  geom_point(size=2,show.legend = FALSE)

```


## Graphics and Statistical Transformations

This time we will be using the `diamonds` dataset

```{r}
summary(diamonds)
ggplot(diamonds,aes(cut)) + geom_bar()
ggplot(diamonds,aes(price)) + geom_histogram(bins=100)
```

Bar charts, histograms and the other plots in the one variable section of the ggplot2 cheat sheet bin your data based on a single variable 

You can determine the computed variables of a graphic by using the help function:

* Computed variables  
    + count  
        - number of points in bin
    + prop  
        - groupwise proportion
        
```{r}
ggplot(diamonds) + geom_bar(aes(x=cut,y=..prop..,group=1))
```

### Position adjustments

```{r}
ggplot(diamonds) + geom_bar(aes(x = color, fill = cut), position = "dodge")
ggplot(diamonds) + geom_bar(aes(x = color, fill = cut), position = "fill")
ggplot(diamonds) + geom_bar(aes(x = color, color = cut), position = "stack",fill=NA)
```

## Some more example plot
```{r}
ggplot(midwest, aes(x=area, y=poptotal)) + 
  geom_point(aes(col=state, size=popdensity)) + 
  geom_smooth(method="loess", se=F) + xlim(c(0, 0.1)) + ylim(c(0, 500000)) + 
  labs(subtitle="Area Vs Population", y="Population", x="Area", title="Scatterplot", caption = "Source: midwest")


```

## Spend some time playing with ggplot
- See <http://ggplot2.tidyverse.org/reference/> for a full list of functions in ggplot
- Here are a list of the datasets built into ggplot
    - diamonds
        - Prices of 50,000 round cut diamonds
    - economics
        - US economic time series
    - faithfuld
        - 2d density estimate of Old Faithful data
    - midwest
        - Midwest demographics
    - mpg
        - Fuel economy data from 1999 and 2008 for 38 popular models of car
    - msleep
        - An updated and expanded version of the mammals sleep dataset
    - presidential
        - Terms of 11 presidents from Eisenhower to Obama
    - seals
        - Vector field of seal movements
    - txhousing
        - Housing sales in TX
    - luv_colours
        - colors() in Luv space



    
    
# SECTION 2 - Data Manipulation    

### Mathematical and Boolean Operators

```{r, error=TRUE}
-sqrt(25) + (5+3)/4*7 - 2^2
5%/%3 # Integer Division
5%%3 # Modulo (remainder after division)
5 == 6
5 != 6
83 > (25 >= 23)
5 > 3 & 3 < 2
5 > 3 | 3 < 2
```


### Vectors and Sequences
```{r}
1:4
c(5,3,2,1) # Creates a vector via concaternation (hence the c)
c(12,1:4,6)
seq(from = 1, t= 10, by = 2) # Creates a vector with the given paramters
seq(1,10,2) # creates the same vector without naming the paramters
seq(1,10) # R uses the default values for any empty parameters
seq(to = 10, by = 2)
seq(by = 2, to = 10)
c(seq(1,10,2), 25, 10)
c(seq(1,10,2), 25, 10) > 12
c(seq(1,10,2), 25, 10) * 2
```




### Variables and Assignment
```{r}
x = 5+3
(x = 5+3)
x <- 5+3
(x <- 5+3)
y <- x
y
x <- 5+3 > 2
x
x <- seq(172,23,-13)
x
```

### Indexing
#### R starts at 1
```{r}
x <- seq(172,23,-13)
x[1]    
x[c(1,3)] 
x[2:4] 
x[4:2] 
x[]
x[-1]
x[-c(1,3)]
x[x%%2==0]
y <- x[x%%2==0]
y[9] <- 10
y
```

### Built in Functions
```{r}
x <-  1:20
mean(x)
max(x)
min(x)
length(x)
range(x)
prod(x)
var(x)
log(x)
sqrt(x)
```




### Exercises
1. Create a vector of 2 through 8 squared:  
4, 9, 16, 25, 36, 49, 64

2. Create a vector of the square roots of the sum of sqaures of every pair of digits of 1 to 100:  
sqrt(1^2 + 2^2), sqrt(3^2 + 4^2), sqrt(5^2 + 6^2), ... , sqrt(99^2 + 100^2)

3. Create a vector of the numbers 1 to 100 not divisible by 3 or 5:  
1, 2, 4, 7, 8, 11, 13, 14, 16, 17, ... , 97, 98




# SECTION 3 -         






























